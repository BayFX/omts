# Expert Review: OMTS Specification Suite (Security & Privacy)

**Reviewer:** Security & Privacy Expert, Data Security & Privacy Architect
**Specs Reviewed:** OMTS-SPEC-001 through OMTS-SPEC-006 (all Draft, 2026-02-18)
**Review Date:** 2026-02-18

---

## Assessment

The OMTS spec suite now represents one of the most privacy-conscious supply chain data exchange formats I have reviewed. Since the initial draft, the authors have addressed the two previously-critical gaps: file-level integrity (SPEC-004 Section 6 now defines a SHA-256 content hash with optional Ed25519/ECDSA-P256 digital signatures) and `nat-reg` default sensitivity (changed from `public` to `restricted` in both SPEC-002 Section 5.1 and SPEC-004 Section 2, explicitly citing the sole proprietorship GDPR risk). Transport security guidance now appears in SPEC-004 Section 7 with scope-appropriate recommendations for TLS 1.3 and GPG/age encryption. The boundary reference test vectors in SPEC-004 Section 4 are now complete with four vectors covering the deterministic hash path, single-identifier path, percent-encoding, and the random-token fallback. These were the right priorities and the execution is solid.

The privacy architecture rests on a well-layered foundation: identifier-level sensitivity classification (SPEC-002), file-level disclosure scope enforcement at L1 validation (SPEC-004 Section 3), salted SHA-256 boundary references for redacted subgraphs (SPEC-004 Section 4), mandatory person node omission from public files (SPEC-004 Section 5), and the "data stays local" principle enforced through the Rust-to-WASM compilation model. The fresh-salt-per-file design is an explicit and well-documented tradeoff: it sacrifices cross-file temporal tracking of redacted entities in favor of anti-enumeration and anti-correlation guarantees. SPEC-004 Section 4 now documents this tradeoff explicitly, which is the right approach.

The remaining security concerns fall into two categories: authentication gaps in the multi-party merge workflow (SPEC-003), and edge-level property sensitivity coverage that lags behind the node/identifier model. The merge provenance structure records source file identifiers and timestamps but carries no authentication chain. In a supply chain context where files traverse multiple trust boundaries -- buyer to tier-1 supplier to tier-2 -- the absence of per-contributor authentication means a malicious actor can inject fabricated nodes into a merged graph with no cryptographic attribution trail. The `file_integrity` mechanism on individual files is necessary but insufficient: the merge output itself needs provenance integrity. Additionally, commercially sensitive edge properties like `contract_ref` and `annual_value` (SPEC-001 Section 6.1) have no sensitivity classification mechanism, creating a gap where node identifiers are carefully protected but edge metadata leaks competitive intelligence.

## Strengths

- **Identifier-level sensitivity granularity.** Attaching sensitivity to individual identifier records (SPEC-002 Section 3) rather than entire nodes allows a single organization node to carry a public LEI, a restricted VAT number, and a confidential internal code, each independently disclosable. This is the correct granularity for supply chain data where the same entity appears in multiple disclosure contexts.

- **Salted boundary references with anti-enumeration properties.** The per-file CSPRNG salt in the SHA-256 hash input (SPEC-004 Section 4) prevents rainbow-table attacks where an adversary hashes known LEI values against boundary references. The random-token fallback for entities with no public identifiers avoids the collision-to-empty-string problem. Four complete test vectors, including the percent-encoding edge case, enable implementer verification.

- **Person node privacy posture.** All person node identifiers default to `confidential` regardless of scheme-level defaults, with mandatory omission (not boundary-ref replacement) from public files (SPEC-004 Section 5). This is a stronger posture than most data exchange formats and correctly reflects GDPR Article 5(1)(c) data minimization for UBO data under AMLD 5/6.

- **Disclosure scope enforcement at L1 validation.** Making disclosure scope violations a structural validation failure (L1-SDI-02) rather than a warning means non-conformant files are rejected by any compliant validator. This creates a hard enforcement boundary that does not depend on consumer diligence.

- **File integrity with algorithm agility.** The `file_integrity` structure (SPEC-004 Section 6) supports SHA-256 content hashing with optional Ed25519 or ECDSA-P256 signatures. The `algorithm` field reserves future agility. The content hash computation excluding the `file_integrity` field itself is the standard self-referential hash construction. The companion `.omts.sha256` file option supports workflows where modifying the file is undesirable.

- **`nat-reg` default sensitivity corrected to `restricted`.** The explicit GDPR rationale citing sole proprietorships (SPEC-002 Section 5.1) ensures producers understand the risk. The override-to-public option for known corporations preserves flexibility.

- **Local processing guarantee.** The Rust-to-WASM compilation model ensures supply chain graphs never need to leave the user's machine. This is architecturally verifiable, not merely a policy statement.

## Concerns

- **[Major] Merge provenance carries no authentication.** The `merge_metadata` structure (SPEC-003 Section 6) records source file identifiers and timestamps but provides no mechanism to cryptographically attribute data to its originating trust domain. When files from multiple organizations are merged, a consumer cannot verify that claimed provenance is authentic or detect injected nodes from a malicious contributor. The individual-file `file_integrity` mechanism does not compose into a chain of custody across merge operations. This is a supply chain data poisoning vector.

- **[Major] No sensitivity model for edge properties.** SPEC-001 Section 6.1 defines `contract_ref` and `annual_value` on `supplies` edges -- both commercially sensitive. There is no mechanism to classify edge property sensitivity or enforce redaction of sensitive edge properties at different disclosure scopes. A file with `disclosure_scope: "public"` passes L1 validation while containing contract reference numbers and annual monetary values that constitute competitive intelligence. The sensitivity model covers node identifiers comprehensively but leaves edge metadata unprotected.

- **[Major] `file_integrity` content hash lacks canonical serialization specification.** SPEC-004 Section 6 states the hash covers "the entire file content as UTF-8 bytes" with the `file_integrity` field excluded (or set to `null`). However, the spec does not define a canonical JSON serialization (key ordering, whitespace, number formatting, Unicode normalization). Two semantically identical files with different JSON formatting will produce different hashes. Without a canonicalization rule, the content hash is implementation-dependent and may fail cross-implementation verification.

- **[Minor] Signature key distribution is unspecified.** SPEC-004 Section 6 supports Ed25519/ECDSA-P256 signatures with a `signer` field, but there is no guidance on how consumers obtain the signer's public key. The spec states "Signature validation is a tooling concern," but without even informative guidance on key distribution (e.g., well-known URI, LEI-linked key directory, out-of-band exchange), signature verification will be impractical in multi-party supply chains and different implementations will adopt incompatible approaches.

- **[Minor] Boundary reference stability gap remains intentional but undocumented as a limitation.** Fresh salt per file prevents cross-file correlation of redacted entities (SPEC-004 Section 4). The spec documents this as a tradeoff but does not provide an opt-in mechanism for producers who need temporal tracking of boundary references across successive snapshots. A producer exporting weekly snapshots of the same subgraph cannot enable a consumer to track entity continuity in the redacted portion.

- **[Minor] `beneficial_ownership` edge sensitivity inheritance is implicit.** SPEC-001 Section 5.5 states these edges "inherit the sensitivity constraints of `person` nodes" and default to `confidential`, but SPEC-004 does not define a general inheritance model for edge sensitivity. The rule is specific to `beneficial_ownership` and relies on prose rather than a formal mechanism. Other edge types connecting to sensitive nodes (e.g., an `operates` edge from a person to a facility, if the model were extended) would lack similar protection.

## Recommendations

1. **(P1) Add authenticated provenance to merge metadata.** Extend `merge_metadata` (SPEC-003 Section 6) to optionally include: (a) the `content_hash` from each source file's `file_integrity` block, and (b) a `contributor` identifier per source file (e.g., the signer's LEI or domain name from the source file's `file_integrity.signer`). This creates a minimal but verifiable chain of custody: a consumer who has access to the original source files can verify that the merged output was constructed from authentic inputs. This does not require PKI infrastructure beyond what `file_integrity` already provides.

2. **(P1) Define canonical JSON serialization for content hashing.** Specify that the content hash in `file_integrity` is computed over a canonical JSON form. At minimum: (a) keys sorted lexicographically at every nesting level, (b) no insignificant whitespace, (c) numbers formatted per RFC 8785 (JSON Canonicalization Scheme). Alternatively, adopt RFC 8785 (JCS) by reference. Without this, cross-implementation content hash verification will fail on semantically identical files.

3. **(P1) Extend the sensitivity model to edge properties.** Define an optional `sensitivity` field on edge property values, or define normative rules that certain edge properties (at minimum `contract_ref`, `annual_value`, `value_currency`) MUST be omitted from files with `disclosure_scope: "public"`. This closes the gap where node identifiers are carefully classified but commercially sensitive edge metadata passes through unprotected.

4. **(P2) Add informative key distribution guidance.** Include a non-normative section in SPEC-004 recommending approaches for signature public key distribution: (a) out-of-band exchange for bilateral partnerships, (b) a well-known URI convention (e.g., `/.well-known/omts-keys.json`) for organizations with web presence, (c) future integration with DID-based key resolution. This does not need to be normative but its absence will fragment implementations.

5. **(P2) Consider a stable boundary reference mode.** Define an optional mechanism where a producer supplies a persistent salt (e.g., derived from a key they control) instead of a fresh CSPRNG salt, enabling stable boundary references across successive exports. Document the tradeoff explicitly: stability enables temporal tracking but weakens anti-enumeration if the persistent salt is compromised. Gate this on an explicit `boundary_ref_mode: "stable"` header field so the default remains the safer fresh-salt behavior.

6. **(P2) Formalize edge sensitivity inheritance.** Generalize the `beneficial_ownership` sensitivity inheritance rule (SPEC-001 Section 5.5) into a formal mechanism in SPEC-004. Define that edges inherit the maximum sensitivity of their endpoint nodes, unless explicitly overridden. This prevents future edge types connecting to sensitive node types from inadvertently leaking through disclosure scope enforcement.

## Cross-Expert Notes

- **For Enterprise Integration Expert:** The ERP mapping tables in SPEC-005 should flag which SAP/Oracle fields map to edge properties that carry competitive intelligence. Specifically, `EKKO-BSART` (contract type), `EKPO-NETPR` (net price), and `EINE` info record pricing data should never appear in `contract_ref` or `annual_value` on `supplies` edges destined for files with `disclosure_scope: "public"`. The ERP integration guide is the natural place for per-field sensitivity guidance that SPEC-004 defines generically.

- **For Data Format Expert:** My Recommendation 2 (canonical JSON serialization) is a hard dependency for reliable `file_integrity` verification. If you are defining serialization rules, please ensure that RFC 8785 (JSON Canonicalization Scheme) compatibility is either adopted by reference or explicitly addressed. The content hash is only useful if two implementations produce identical bytes from the same logical document.

- **For Graph Modeling Expert:** The boundary reference design in SPEC-004 Section 4 works well for single-hop redaction but does not address transitive redaction. If a node A connects to boundary_ref B, and B originally connected to node C (now also redacted), the two-hop structure collapses into A connected to B. In a deeply nested supply chain, multi-hop redaction may produce subgraphs where all depth-2+ suppliers collapse into a single boundary reference layer, losing structural information about the depth of the redacted portion. Consider whether a `depth` property on boundary_ref nodes would preserve useful structural metadata without compromising privacy.

- **For Regulatory Compliance Expert:** The `beneficial_ownership` edge sensitivity model (confidential by default, omitted from public files) is well-aligned with AMLD 5/6 requirements. However, the EU's 6th Anti-Money Laundering Directive (AMLD 6) is converging toward the Anti-Money Laundering Regulation (AMLR), which may introduce different beneficial ownership transparency thresholds. The current 25% threshold mentioned in SPEC-001 Section 5.5 is a tooling concern per the spec, which is correct -- but the sensitivity defaults should be reviewed if AMLR mandates public beneficial ownership registers with different disclosure rules.

- **For Standards Expert:** The `file_integrity` mechanism (Ed25519/ECDSA-P256 signatures) aligns with the W3C Data Integrity ECDSA Cryptosuites v1.0 (REC-vc-di-ecdsa-20250515) and EdDSA Cryptosuites v1.0, which achieved W3C Recommendation status in May 2025. OMTS's approach is simpler (detached signature over content hash rather than linked-data proofs), which is appropriate for a file format. If OMTS seeks formal standardization, the alignment with FIPS 186-5 (which now includes Ed25519) strengthens the case.

- **For Open Source Strategy Expert:** The "data stays local" principle is architecturally sound but depends on the reference implementation not introducing telemetry, analytics, or external API calls in its WASM build. The project should establish a verifiable build pipeline and a policy statement that the WASM binary contains no network-calling code. This is both a security requirement and a trust-building measure for enterprise adoption.
